<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶™‡ßç‡¶∞‡¶´‡ßá‡¶∂‡¶®‡¶æ‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶è‡¶°‡¶ø‡¶ü‡¶∞</title>
    <style>
        :root { --primary: #7ea3f2; --bg: #f8f9fa; --share-btn: #25D366; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding: 10px; }
        
        .main-wrapper { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; max-width: 1100px; margin: 20px auto; }
        
        /* ‡¶¨‡¶æ‡¶Æ‡¶™‡¶æ‡¶∂ - ‡¶õ‡¶¨‡¶ø ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â */
        .preview-section { flex: 1; min-width: 320px; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); text-align: center; }
        #canvas-container { position: relative; width: 100%; aspect-ratio: 1/1; background: #eee; overflow: hidden; border-radius: 8px; cursor: move; touch-action: none; }
        canvas { width: 100% !important; height: auto !important; display: block; }

        /* ‡¶°‡¶æ‡¶®‡¶™‡¶æ‡¶∂ - ‡¶ü‡ßÅ‡¶≤‡¶∏ */
        .tools-section { width: 350px; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .tool-group { margin-bottom: 20px; border-bottom: 1px dashed #eee; padding-bottom: 15px; }
        .label-step { font-weight: bold; font-size: 14px; display: block; margin-bottom: 8px; color: #444; }
        
        input[type="text"] { width: 92%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; outline: none; transition: 0.3s; }
        input[type="text"]:focus { border-color: var(--primary); }
        
        .btn-upload-box { border: 2px dashed #d1d9e6; padding: 15px; border-radius: 8px; cursor: pointer; text-align: center; transition: 0.3s; }
        .btn-upload-box:hover { background: #f0f4ff; }
        
        .zoom-slider { width: 100%; margin: 10px 0; cursor: pointer; }
        
        .btn-action { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; margin-bottom: 10px; transition: 0.3s; }
        .btn-download { background: var(--primary); color: white; }
        .btn-share { background: var(--share-btn); color: white; font-size: 14px; line-height: 1.2; }
        .btn-action:active { transform: scale(0.98); }

        @media (max-width: 768px) {
            .tools-section { width: 100%; order: 2; }
            .preview-section { order: 1; }
        }
    </style>
</head>
<body>

<div class="main-wrapper">
    <div class="preview-section">
        <div id="canvas-container">
            <canvas id="canvas"></canvas>
        </div>
        <p style="font-size: 12px; color: #999; margin-top: 10px;">‡¶õ‡¶¨‡¶ø‡¶ü‡¶ø ‡¶Ü‡¶ô‡ßÅ‡¶≤ ‡¶¶‡¶ø‡ßü‡ßá ‡¶ü‡ßá‡¶®‡ßá ‡¶™‡¶ú‡¶ø‡¶∂‡¶® ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
    </div>

    <div class="tools-section">
        <h3 style="margin-top:0">‡¶è‡¶°‡¶ø‡¶ü‡¶∞ ‡¶ü‡ßÅ‡¶≤‡¶∏</h3>
        
        <div class="tool-group">
            <span class="label-step">‡ßß. ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®</span>
            <input type="text" id="nameInput" value="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" oninput="draw()">
        </div>

        <div class="tool-group">
            <span class="label-step">‡ß®. ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>
            <input type="file" id="upload" accept="image/*" style="display:none">
            <div class="btn-upload-box" onclick="document.getElementById('upload').click()">
                <span id="file-name" style="color:var(--primary); font-weight:bold;">+ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</span>
            </div>
        </div>

        <div class="tool-group">
            <span class="label-step">‡ß©. ‡¶õ‡¶¨‡¶ø ‡¶ú‡ßÅ‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®</span>
            <input type="range" id="zoom" class="zoom-slider" min="0.1" max="4" step="0.01" value="1">
        </div>

        <button class="btn-action btn-download" id="downloadBtn">‚¨áÔ∏è ‡¶õ‡¶¨‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button class="btn-action btn-share" id="shareBtn">üì¢ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® <br><small>(WhatsApp & Messenger)</small></button>
    </div>
</div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const upload = document.getElementById('upload');
    const zoomSlider = document.getElementById('zoom');
    const downloadBtn = document.getElementById('downloadBtn');
    const shareBtn = document.getElementById('shareBtn');
    const nameInput = document.getElementById('nameInput');

    let userImg = new Image();
    let frameImg = new Image();
    let imgX = 0, imgY = 0, scale = 1;
    let isDragging = false, startX, startY;

    // ‡ßß. ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨‡ßá frame.png ‡¶®‡¶æ‡¶Æ‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá)
    frameImg.src = 'frame.png'; 
    frameImg.onload = () => {
        canvas.width = 1000; 
        canvas.height = 1000;
        draw();
    };

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø ‡¶°‡ßç‡¶∞‡ßü‡¶ø‡¶Ç
        if (userImg.src) {
            ctx.save();
            ctx.translate(canvas.width/2 + imgX, canvas.height/2 + imgY);
            ctx.scale(scale, scale);
            ctx.drawImage(userImg, -userImg.width/2, -userImg.height/2);
            ctx.restore();
        }

        // ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶°‡ßç‡¶∞‡ßü‡¶ø‡¶Ç (‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶ì‡¶™‡¶∞‡ßá)
        ctx.drawImage(frameImg, 0, 0, canvas.width, canvas.height);

        // ‡¶®‡¶æ‡¶Æ ‡¶°‡ßç‡¶∞‡ßü‡¶ø‡¶Ç (‡ßß‡ß≠ ‡¶™‡¶ø‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡¶ø‡¶Ç ‡¶∞‡ßá‡¶ñ‡ßá ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶®‡¶ø‡¶ö‡ßá)
        const nameText = nameInput.value;
        if (nameText) {
            ctx.textAlign = "center";
            ctx.font = "bold 50px 'Segoe UI', Arial, sans-serif";
            ctx.fillStyle = "white"; 
            // ‡ßß‡ß≠ ‡¶™‡¶ø‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡¶ø‡¶Ç (‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡¶≠‡¶æ‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶™‡ßç‡¶∞‡¶æ‡ßü ‡ß™‡ß¶ ‡¶™‡¶ø‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶â‡¶™‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
            ctx.fillText(nameText, canvas.width/2, canvas.height - 40); 
        }
    }

    // ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï
    upload.onchange = (e) => {
        const file = e.target.files[0];
        if(!file) return;
        const reader = new FileReader();
        reader.onload = (f) => {
            userImg.onload = () => {
                scale = Math.max(canvas.width / userImg.width, canvas.height / userImg.height);
                zoomSlider.value = scale;
                imgX = 0; imgY = 0;
                draw();
            };
            userImg.src = f.target.result;
        };
        reader.readAsDataURL(file);
    };

    // ‡¶ú‡ßÅ‡¶Æ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï
    zoomSlider.oninput = (e) => { scale = parseFloat(e.target.value); draw(); };

    // ‡¶õ‡¶¨‡¶ø ‡¶®‡¶æ‡ßú‡¶æ‡¶ö‡¶æ‡ßú‡¶æ (Drag) ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï
    const container = document.getElementById('canvas-container');
    const getPos = (e) => e.touches ? e.touches[0] : e;
    const startDrag = (e) => { isDragging = true; startX = getPos(e).clientX - imgX; startY = getPos(e).clientY - imgY; };
    const doDrag = (e) => { if(!isDragging) return; imgX = getPos(e).clientX - startX; imgY = getPos(e).clientY - startY; draw(); };
    const stopDrag = () => isDragging = false;

    container.onmousedown = startDrag; container.ontouchstart = startDrag;
    window.onmousemove = doDrag; window.ontouchmove = doDrag;
    window.onmouseup = stopDrag; window.ontouchend = stopDrag;

    // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶è‡¶¨‡¶Ç ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï
    downloadBtn.onclick = () => {
        // ‡¶®‡¶ø‡¶ö‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Adsterra ‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶¨‡¶∏‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶®
        const adLink = "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞_ADSTERRA_DIRECT_LINK_‡¶è‡¶ñ‡¶æ‡¶®‡ßá_‡¶¶‡¶ø‡¶®";
        window.open(adLink, '_blank');

        const link = document.createElement('a');
        link.download = 'my_poster.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    };

    // ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï (WhatsApp, Messenger, etc.)
    shareBtn.onclick = async () => {
        const shareData = {
            title: '‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶§‡ßà‡¶∞‡¶ø ‡¶™‡ßã‡¶∑‡ßç‡¶ü‡¶æ‡¶∞',
            text: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶∞‡¶æ, ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶á ‡¶∏‡¶æ‡¶á‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶™‡ßã‡¶∑‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶®‡¶ø‡ßü‡ßá‡¶õ‡¶ø‡•§ ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ‡¶ì ‡¶ü‡ßç‡¶∞‡¶æ‡¶á ‡¶ï‡¶∞‡ßã!',
            url: window.location.href
        };

        try {
            if (navigator.share) {
                await navigator.share(shareData);
            } else {
                await navigator.clipboard.writeText(window.location.href);
                alert("‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶è‡¶ñ‡¶® ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶®‡•§");
            }
        } catch (err) { console.log('Error sharing:', err); }
    };
</script>

</body>
</html>
